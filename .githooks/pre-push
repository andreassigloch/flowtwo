#!/bin/bash
# Pre-push hook for GraphEngine
# Runs quality checks before allowing push to remote
set -e

echo ""
echo "ğŸ” Running Pre-Push Quality Checks..."
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Step 1: Documentation Audit
echo "ğŸ“‹ Step 1/2: Documentation Audit..."
npx tsx scripts/checks/documentation-audit.ts

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Documentation audit failed."
  echo "   Fix root directory documentation before pushing."
  echo "   Run: npx tsx scripts/checks/documentation-audit.ts"
  exit 1
fi

echo ""

# Step 2: Code Quality Checks
echo "ğŸ” Step 2/2: Code Quality Checks..."
npx tsx scripts/quality-check.ts

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Code quality checks failed."
  echo "   Fix the issues above before pushing."
  echo "   To bypass (not recommended): git push --no-verify"
  exit 1
fi

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âœ… All quality checks passed! Proceeding with push..."
echo ""

exit 0
